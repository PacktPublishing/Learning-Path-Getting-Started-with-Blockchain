var bettingContractByteCode = "606060405234156200000d57fe5b6040516200272b3803806200272b833981016040528080518201919060200180519060200190919080518201919050505b82600290805190602001906200005692919062000686565b508160038190555080600490805190602001906200007692919062000686565b50620000de60017f01000000000000000000000000000000000000000000000000000000000000000260107f01000000000000000000000000000000000000000000000000000000000000000217620000e86401000000000262001d6d176401000000009004565b5b50505062000735565b6000600060009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16148062000170575060006200016e600060009054906101000a900473ffffffffffffffffffffffffffffffffffffffff166200036764010000000002620019ec176401000000009004565b145b1562000198576200019660006200037364010000000002620019f8176401000000009004565b505b600060009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff166338cc48316000604051602001526040518163ffffffff167c0100000000000000000000000000000000000000000000000000000000028152600401809050602060405180830381600087803b15156200022757fe5b60325a03f115156200023557fe5b50505060405180519050600160006101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff160217905550600160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1663688dcfd7826040518263ffffffff167c010000000000000000000000000000000000000000000000000000000002815260040180827effffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff19167effffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff19168152602001915050600060405180830381600087803b15156200035157fe5b60325a03f115156200035f57fe5b5050505b5b50565b6000813b90505b919050565b60006000620003aa731d3b2638a7cc9f2cb3d298a3da7a90b67e5506ed6200036764010000000002620019ec176401000000009004565b11156200041057731d3b2638a7cc9f2cb3d298a3da7a90b67e5506ed600060006101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff1602179055506001905062000681565b60006200044573c03a2615d5efaf5f49f60b7bb6583eaec212fdf16200036764010000000002620019ec176401000000009004565b1115620004ab5773c03a2615d5efaf5f49f60b7bb6583eaec212fdf1600060006101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff1602179055506001905062000681565b6000620004e0736f485c8bf6fc43ea212e93bbf8ce046c7f1cb4756200036764010000000002620019ec176401000000009004565b11156200054657736f485c8bf6fc43ea212e93bbf8ce046c7f1cb475600060006101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff1602179055506001905062000681565b60006200057b7320e12a1f859b3feae5fb2a0a32c18f5a65555bbf6200036764010000000002620019ec176401000000009004565b1115620005e1577320e12a1f859b3feae5fb2a0a32c18f5a65555bbf600060006101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff1602179055506001905062000681565b6000620006167351efaf4c8b3c9afbd5ab9f4bbc82784ab6ef8faa6200036764010000000002620019ec176401000000009004565b11156200067c577351efaf4c8b3c9afbd5ab9f4bbc82784ab6ef8faa600060006101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff1602179055506001905062000681565b600090505b919050565b828054600181600116156101000203166002900490600052602060002090601f016020900481019282601f10620006c957805160ff1916838001178555620006fa565b82800160010185558215620006fa579182015b82811115620006f9578251825591602001919060010190620006dc565b5b5090506200070991906200070d565b5090565b6200073291905b808211156200072e57600081600090555060010162000714565b5090565b90565b611fe680620007456000396000f3006060604052361561008c576000357c0100000000000000000000000000000000000000000000000000000000900463ffffffff1680630866ebe31461008e57806327dc297e146100a657806338bbfa501461010d5780635600f04f146101b757806399892e4714610250578063aa8c217c146102e9578063e5e0fd8d1461030f578063fac8cdcd14610361575bfe5b6100a460048080359060200190919050506103b3565b005b34156100ae57fe5b61010b60048080356000191690602001909190803590602001908201803590602001908080601f016020809104026020016040519081016040528093929190818152602001838380828437820191505050505050919050506107df565b005b341561011557fe5b6101b560048080356000191690602001909190803590602001908201803590602001908080601f0160208091040260200160405190810160405280939291908181526020018383808284378201915050505050509190803590602001908201803590602001908080601f0160208091040260200160405190810160405280939291908181526020018383808284378201915050505050509190505061080f565b005b34156101bf57fe5b6101c7610d3f565b6040518080602001828103825283818151815260200191508051906020019080838360008314610216575b805182526020831115610216576020820191506020810190506020830392506101f2565b505050905090810190601f1680156102425780820380516001836020036101000a031916815260200191505b509250505060405180910390f35b341561025857fe5b610260610ddd565b60405180806020018281038252838181518152602001915080519060200190808383600083146102af575b8051825260208311156102af5760208201915060208101905060208303925061028b565b505050905090810190601f1680156102db5780820380516001836020036101000a031916815260200191505b509250505060405180910390f35b34156102f157fe5b6102f9610e7b565b6040518082815260200191505060405180910390f35b341561031757fe5b61031f610e81565b604051808273ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200191505060405180910390f35b341561036957fe5b610371610ea7565b604051808273ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200191505060405180910390f35b60018114156105c4576000600560009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1614156105ba576003543414156105b05733600560006101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff1602179055506000600560009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16141580156104ca57506000600660009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1614155b156105ab576105a9604060405190810160405280600381526020017f55524c000000000000000000000000000000000000000000000000000000000081525060048054600181600116156101000203166002900480601f01602080910402602001604051908101604052809291908181526020018280546001816001161561010002031660029004801561059f5780601f106105745761010080835404028352916020019161059f565b820191906000526020600020905b81548152906001019060200180831161058257829003601f168201915b5050505050610ecd565b505b6105b5565b610000565b6105bf565b610000565b6107db565b60028114156107d5576000600660009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1614156107cb576003543414156107c15733600660006101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff1602179055506000600560009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16141580156106db57506000600660009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1614155b156107bc576107ba604060405190810160405280600381526020017f55524c000000000000000000000000000000000000000000000000000000000081525060048054600181600116156101000203166002900480601f0160208091040260200160405190810160405280929190818152602001828054600181600116156101000203166002900480156107b05780601f10610785576101008083540402835291602001916107b0565b820191906000526020600020905b81548152906001019060200180831161079357829003601f168201915b5050505050610ecd565b505b6107c6565b610000565b6107d0565b610000565b6107da565b610000565b5b5b50565b61080a828260006040518059106107f35750595b908082528060200260200182016040525b5061080f565b5b5050565b61081761132e565b73ffffffffffffffffffffffffffffffffffffffff163373ffffffffffffffffffffffffffffffffffffffff1614151561085057610000565b6108a9610892604060405190810160405280600481526020017f686f6d6500000000000000000000000000000000000000000000000000000000815250611543565b61089b84611543565b61157390919063ffffffff16565b1561092557600560009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff166108fc3073ffffffffffffffffffffffffffffffffffffffff16319081150290604051809050600060405180830381858888f1935050505050610d38565b61097e610967604060405190810160405280600481526020017f6177617900000000000000000000000000000000000000000000000000000000815250611543565b61097084611543565b61157390919063ffffffff16565b156109fa57600660009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff166108fc3073ffffffffffffffffffffffffffffffffffffffff16319081150290604051809050600060405180830381858888f1935050505050610d37565b610a53610a3c604060405190810160405280600481526020017f6472617700000000000000000000000000000000000000000000000000000000815250611543565b610a4584611543565b61157390919063ffffffff16565b15610b5957600560009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff166108fc60023073ffffffffffffffffffffffffffffffffffffffff1631811515610ab757fe5b049081150290604051809050600060405180830381858888f1935050505050600660009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff166108fc60023073ffffffffffffffffffffffffffffffffffffffff1631811515610b3557fe5b049081150290604051809050600060405180830381858888f1935050505050610d36565b3073ffffffffffffffffffffffffffffffffffffffff1631600160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1663524f38896000604051602001526040518163ffffffff167c01000000000000000000000000000000000000000000000000000000000281526004018080602001828103825260038152602001807f55524c0000000000000000000000000000000000000000000000000000000000815250602001915050602060405180830381600087803b1515610c3857fe5b60325a03f11515610c4557fe5b505050604051805190501015610d3557610d3362015180604060405190810160405280600381526020017f55524c000000000000000000000000000000000000000000000000000000000081525060048054600181600116156101000203166002900480601f016020809104026020016040519081016040528092919081815260200182805460018160011615610100020316600290048015610d295780601f10610cfe57610100808354040283529160200191610d29565b820191906000526020600020905b815481529060010190602001808311610d0c57829003601f168201915b505050505061158b565b505b5b5b5b5b5b505050565b60048054600181600116156101000203166002900480601f016020809104026020016040519081016040528092919081815260200182805460018160011615610100020316600290048015610dd55780601f10610daa57610100808354040283529160200191610dd5565b820191906000526020600020905b815481529060010190602001808311610db857829003601f168201915b505050505081565b60028054600181600116156101000203166002900480601f016020809104026020016040519081016040528092919081815260200182805460018160011615610100020316600290048015610e735780601f10610e4857610100808354040283529160200191610e73565b820191906000526020600020905b815481529060010190602001808311610e5657829003601f168201915b505050505081565b60035481565b600560009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1681565b600660009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1681565b600060006000600060009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff161480610f4257506000610f40600060009054906101000a900473ffffffffffffffffffffffffffffffffffffffff166119ec565b145b15610f5357610f5160006119f8565b505b600060009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff166338cc48316000604051602001526040518163ffffffff167c0100000000000000000000000000000000000000000000000000000000028152600401809050602060405180830381600087803b1515610fe157fe5b60325a03f11515610fee57fe5b50505060405180519050600160006101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff160217905550600160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1663524f3889856000604051602001526040518263ffffffff167c010000000000000000000000000000000000000000000000000000000002815260040180806020018281038252838181518152602001915080519060200190808383600083146110fa575b8051825260208311156110fa576020820191506020810190506020830392506110d6565b505050905090810190601f1680156111265780820380516001836020036101000a031916815260200191505b5092505050602060405180830381600087803b151561114157fe5b60325a03f1151561114e57fe5b50505060405180519050905062030d403a02670de0b6b3a76400000181111561117d5760006001029150611326565b600160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1663adf59f9982600087876000604051602001526040518563ffffffff167c010000000000000000000000000000000000000000000000000000000002815260040180848152602001806020018060200183810383528581815181526020019150805190602001908083836000831461124d575b80518252602083111561124d57602082019150602081019050602083039250611229565b505050905090810190601f1680156112795780820380516001836020036101000a031916815260200191505b508381038252848181518152602001915080519060200190808383600083146112c1575b8051825260208311156112c15760208201915060208101905060208303925061129d565b505050905090810190601f1680156112ed5780820380516001836020036101000a031916815260200191505b50955050505050506020604051808303818588803b151561130a57fe5b61235a5a03f1151561131857fe5b505050506040518051905091505b5b5092915050565b60006000600060009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1614806113a15750600061139f600060009054906101000a900473ffffffffffffffffffffffffffffffffffffffff166119ec565b145b156113b2576113b060006119f8565b505b600060009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff166338cc48316000604051602001526040518163ffffffff167c0100000000000000000000000000000000000000000000000000000000028152600401809050602060405180830381600087803b151561144057fe5b60325a03f1151561144d57fe5b50505060405180519050600160006101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff160217905550600160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1663c281d19e6000604051602001526040518163ffffffff167c0100000000000000000000000000000000000000000000000000000000028152600401809050602060405180830381600087803b151561152557fe5b60325a03f1151561153257fe5b5050506040518051905090505b5b90565b61154b611d52565b6000602083019050604060405190810160405280845181526020018281525091505b50919050565b600060006115818484611c93565b1490505b92915050565b600060006000600060009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff161480611600575060006115fe600060009054906101000a900473ffffffffffffffffffffffffffffffffffffffff166119ec565b145b156116115761160f60006119f8565b505b600060009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff166338cc48316000604051602001526040518163ffffffff167c0100000000000000000000000000000000000000000000000000000000028152600401809050602060405180830381600087803b151561169f57fe5b60325a03f115156116ac57fe5b50505060405180519050600160006101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff160217905550600160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1663524f3889856000604051602001526040518263ffffffff167c010000000000000000000000000000000000000000000000000000000002815260040180806020018281038252838181518152602001915080519060200190808383600083146117b8575b8051825260208311156117b857602082019150602081019050602083039250611794565b505050905090810190601f1680156117e45780820380516001836020036101000a031916815260200191505b5092505050602060405180830381600087803b15156117ff57fe5b60325a03f1151561180c57fe5b50505060405180519050905062030d403a02670de0b6b3a76400000181111561183b57600060010291506119e3565b600160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1663adf59f99828787876000604051602001526040518563ffffffff167c010000000000000000000000000000000000000000000000000000000002815260040180848152602001806020018060200183810383528581815181526020019150805190602001908083836000831461190a575b80518252602083111561190a576020820191506020810190506020830392506118e6565b505050905090810190601f1680156119365780820380516001836020036101000a031916815260200191505b5083810382528481815181526020019150805190602001908083836000831461197e575b80518252602083111561197e5760208201915060208101905060208303925061195a565b505050905090810190601f1680156119aa5780820380516001836020036101000a031916815260200191505b50955050505050506020604051808303818588803b15156119c757fe5b61235a5a03f115156119d557fe5b505050506040518051905091505b5b509392505050565b6000813b90505b919050565b60006000611a19731d3b2638a7cc9f2cb3d298a3da7a90b67e5506ed6119ec565b1115611a7d57731d3b2638a7cc9f2cb3d298a3da7a90b67e5506ed600060006101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff16021790555060019050611c8e565b6000611a9c73c03a2615d5efaf5f49f60b7bb6583eaec212fdf16119ec565b1115611b005773c03a2615d5efaf5f49f60b7bb6583eaec212fdf1600060006101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff16021790555060019050611c8e565b6000611b1f736f485c8bf6fc43ea212e93bbf8ce046c7f1cb4756119ec565b1115611b8357736f485c8bf6fc43ea212e93bbf8ce046c7f1cb475600060006101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff16021790555060019050611c8e565b6000611ba27320e12a1f859b3feae5fb2a0a32c18f5a65555bbf6119ec565b1115611c06577320e12a1f859b3feae5fb2a0a32c18f5a65555bbf600060006101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff16021790555060019050611c8e565b6000611c257351efaf4c8b3c9afbd5ab9f4bbc82784ab6ef8faa6119ec565b1115611c89577351efaf4c8b3c9afbd5ab9f4bbc82784ab6ef8faa600060006101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff16021790555060019050611c8e565b600090505b919050565b6000600060006000600060006000600060008a6000015197508a600001518a600001511015611cc457896000015197505b8a60200151965089602001519550600094505b87851015611d365786519350855192508284141515611d1e57600185896020030160080260020a03199150818316828516039050600081141515611d1d57809850611d44565b5b6020870196506020860195505b602085019450611cd7565b89600001518b600001510398505b505050505050505092915050565b60406040519081016040528060008152602001600081525090565b6000600060009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff161480611dde57506000611ddc600060009054906101000a900473ffffffffffffffffffffffffffffffffffffffff166119ec565b145b15611def57611ded60006119f8565b505b600060009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff166338cc48316000604051602001526040518163ffffffff167c0100000000000000000000000000000000000000000000000000000000028152600401809050602060405180830381600087803b1515611e7d57fe5b60325a03f11515611e8a57fe5b50505060405180519050600160006101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff160217905550600160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1663688dcfd7826040518263ffffffff167c010000000000000000000000000000000000000000000000000000000002815260040180827effffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff19167effffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff19168152602001915050600060405180830381600087803b1515611fa557fe5b60325a03f11515611fb257fe5b5050505b5b505600a165627a7a7230582015d79396ed70857d6f057599b0b2a44bb0402f1ed96b085b1711e1c22422656d0029";
var bettingContractABI = [{"constant":false,"inputs":[{"name":"team","type":"uint256"}],"name":"betOnTeam","outputs":[],"payable":true,"type":"function"},{"constant":false,"inputs":[{"name":"myid","type":"bytes32"},{"name":"result","type":"string"}],"name":"__callback","outputs":[],"payable":false,"type":"function"},{"constant":false,"inputs":[{"name":"myid","type":"bytes32"},{"name":"result","type":"string"},{"name":"proof","type":"bytes"}],"name":"__callback","outputs":[],"payable":false,"type":"function"},{"constant":true,"inputs":[],"name":"url","outputs":[{"name":"","type":"string"}],"payable":false,"type":"function"},{"constant":true,"inputs":[],"name":"matchId","outputs":[{"name":"","type":"string"}],"payable":false,"type":"function"},{"constant":true,"inputs":[],"name":"amount","outputs":[{"name":"","type":"uint256"}],"payable":false,"type":"function"},{"constant":true,"inputs":[],"name":"homeBet","outputs":[{"name":"","type":"address"}],"payable":false,"type":"function"},{"constant":true,"inputs":[],"name":"awayBet","outputs":[{"name":"","type":"address"}],"payable":false,"type":"function"},{"inputs":[{"name":"_matchId","type":"string"},{"name":"_amount","type":"uint256"},{"name":"_url","type":"string"}],"payable":false,"type":"constructor"}];

var web3 = new Web3(new Web3.providers.HttpProvider("http://localhost:8545"));

function getAJAXObject()
{
	var request;
	if (window.XMLHttpRequest) {
	    request = new XMLHttpRequest();
	} else if (window.ActiveXObject) {
	    try {
	        request = new ActiveXObject("Msxml2.XMLHTTP");
	    } catch (e) {
	        try {
	            request = new ActiveXObject("Microsoft.XMLHTTP");
	        } catch (e) {}
	    }
	}

	return request;
}

document.getElementById("deploy").addEventListener("submit", function(e){
	e.preventDefault();

	var fromAddress = document.querySelector("#deploy #fromAddress").value;
	var privateKey = document.querySelector("#deploy #privateKey").value;
	var matchId = document.querySelector("#deploy #matchId").value;
	var betAmount = document.querySelector("#deploy #betAmount").value;

	var url = "/getURL?matchId=" + matchId;

	var request = getAJAXObject();

	request.open("GET", url);

	request.onreadystatechange = function() {
	    if (request.readyState == 4) {
	        if (request.status == 200) {
	            if(request.responseText != "An error occured")
	            {
	            	var queryURL = request.responseText;

	            	var contract = web3.eth.contract(bettingContractABI);

					var data = contract.new.getData(matchId, web3.toWei(betAmount, "ether"), queryURL, {
						data: bettingContractByteCode
					});

					var gasRequired = web3.eth.estimateGas({
					    data: "0x" + data
					});

					web3.eth.getTransactionCount(fromAddress, function(error, nonce){

						var rawTx = {
					        gasPrice: web3.toHex(web3.eth.gasPrice),
					        gasLimit: web3.toHex(gasRequired),
					        from: fromAddress,
					        nonce: web3.toHex(nonce),
					        data: "0x" + data,
					    };

					    privateKey = EthJS.Util.toBuffer(privateKey, "hex");

					    var tx = new EthJS.Tx(rawTx);
						tx.sign(privateKey);

						web3.eth.sendRawTransaction("0x" + tx.serialize().toString("hex"), function(err, hash) {
							if(!err)
							{
								document.querySelector("#deploy #message").innerHTML = "Transaction Hash: " + hash + ". Transaction is mining...";

								var timer = window.setInterval(function(){
									web3.eth.getTransactionReceipt(hash, function(err, result){
										if(result)
										{
											window.clearInterval(timer);
											document.querySelector("#deploy #message").innerHTML = "Transaction Hash: " + hash + " and contract address is: " + result.contractAddress;
										}
									})
								}, 10000)
							}
							else
							{
								document.querySelector("#deploy #message").innerHTML = err;
							}
						});
					})

	            }
	        }
	    }
	};

	request.send(null);

}, false)

document.getElementById("bet").addEventListener("submit", function(e){
	e.preventDefault();

	var fromAddress = document.querySelector("#bet #fromAddress").value;
	var privateKey = document.querySelector("#bet #privateKey").value;
	var contractAddress = document.querySelector("#bet #contractAddress").value;
	var team = document.querySelector("#bet #team").value;

	if(team == "Home")
	{
		team = 1;
	}
	else
	{
		team = 2;
	} 

	var contract = web3.eth.contract(bettingContractABI).at(contractAddress);
	var amount = contract.amount();

	var data = contract.betOnTeam.getData(team);

	var gasRequired = contract.betOnTeam.estimateGas(team, {
		from: fromAddress,
		value: amount,
		to: contractAddress
	})

	web3.eth.getTransactionCount(fromAddress, function(error, nonce){

		var rawTx = {
	        gasPrice: web3.toHex(web3.eth.gasPrice),
	        gasLimit: web3.toHex(gasRequired),
	        from: fromAddress,
	        nonce: web3.toHex(nonce),
	        data: data,
	        to: contractAddress,
	        value: web3.toHex(amount)
	    };

	    privateKey = EthJS.Util.toBuffer(privateKey, "hex");

	    var tx = new EthJS.Tx(rawTx);
		tx.sign(privateKey);

		web3.eth.sendRawTransaction("0x" + tx.serialize().toString("hex"), function(err, hash) {
			if(!err)
			{
				document.querySelector("#bet #message").innerHTML = "Transaction Hash: " + hash;
			}
			else
			{
				document.querySelector("#bet #message").innerHTML = err;
			}
		})
	})
}, false)

document.getElementById("find").addEventListener("submit", function(e){
	e.preventDefault();

	var contractAddress = document.querySelector("#find #contractAddress").value;
	var contract = web3.eth.contract(bettingContractABI).at(contractAddress);

	var matchId = contract.matchId();
	var amount = contract.amount();
	var homeAddress = contract.homeBet();
	var awayAddress = contract.awayBet();

	document.querySelector("#find #message").innerHTML = "Contract balance is: " + web3.fromWei(web3.eth.getBalance(contractAddress), "ether") + ", Match ID is: " + matchId + ", bet amount is: " + web3.fromWei(amount, "ether") + " ETH, " + homeAddress + " has placed bet on home team and " + awayAddress + " has placed bet on away team";
}, false)